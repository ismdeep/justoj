{extend name="extra@themes/mincss/layout/user" /}
{block name='titlepart'}{$lang['change_password']} - {$lang['justoj']}{/block}
{block name="body"}
<div class="container">
    <div>
        <h3>{$lang.change_password}</h3>
        <form id="resetPasswordForm">
            <div>
                <span>{$lang.password}：</span><input type="password" name="password">
            </div>
            <div>
                <span>{$lang.password_again}：</span><input type="password" name="password_again">
            </div>
            <div>
                <p>
                    <button type="submit">{$lang.submit}</button>
                    <button type="button">{$lang.reset}</button>
                </p>
            </div>
        </form>
    </div>
</div>

<script type="text/javascript">
$('#resetPasswordForm').on('submit',function(){
    layer.load();
    console.log($('#resetPasswordForm').serialize());
    $.post('/api/User/change_password',$('#resetPasswordForm').serialize(),function(d){
        console.log(d);
        layer.closeAll('loading');
        if ('success' == d.status) {
            layer.alert('password changed',function(){
                location.href = '/';
            });
        }else{
            layer.alert(d.msg);
        }
    },'json');
    return false;
});
</script>
{/block}
