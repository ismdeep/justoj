<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{$lang['login']} - {$lang['justoj']}</title>
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <link href="/static/mincss/entireframework.min.css" rel="stylesheet" type="text/css">
    <script src="/static/jquery/1.12.4/jquery.min.js"></script>
</head>
<body>

<div class="container">
    <form method="post" class="layui-form" id="login-form" onsubmit="return do_login();">
        <p>
            <span class="addon">{$lang.username}</span><input name="username" id="username" placeholder="{$lang.username}"  type="text" lay-verify="required" class="smooth" >
        </p>
        <p>
            <span class="addon">{$lang.password}</span><input name="password" id="password" lay-verify="required" placeholder="{$lang.password}"  type="password" class="smooth">
        </p>
        <p>
            <button class="btn btn-a btn-sm" type="submit">{$lang.login}</button>
            <span style="color: red" id="error-info"></span>
        </p>
        <hr class="hr20" >
        <p>
            <a style="color: blue" href="/">{$lang.home}</a>&nbsp;&nbsp;&nbsp;&nbsp;
            <a style="color: blue" href="/register">{$lang.register}</a>&nbsp;&nbsp;&nbsp;&nbsp;
            <a style="color: blue" href="javascript:" onclick="forgot_password();">{$lang.forgot_password}?</a>
        </p>
    </form>
</div>

<script type="text/javascript">
    function do_login() {
        var loginData = {
            'username': $('#username').val(),
            'password': $('#password').val()
        };
        $.post('/api/login/login',loginData,function(d){
            if ('success' == d.status) {
                localStorage.setItem('username', loginData.username);
                localStorage.setItem('password', loginData.password);
                setTimeout(function(){
                    location.href = '{$redirect}';
                },100);
            }else{
                $('#error-info').html(d.msg);
            }
        });
        return false;
    }

    function forgot_password() {
        alert('忘记密码，请联系任课老师前往后台(用户管理 - 用户管理)进行修改密码。');
    }

    $(function(){
        $('#username').val( localStorage.getItem('username') );
        $('#password').val( localStorage.getItem('password') );
    });
</script>

</body>
</html>